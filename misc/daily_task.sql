	SELECT uid, SUM(CASE WHEN function_type = 28 THEN CASE WHEN sub_function_type = 3 THEN amount ELSE 0 END ELSE 0 END) video_revenue_diamond_with_video, SUM(CASE WHEN function_type = 2 THEN amount ELSE 0 END) chat_gift_diamond, SUM(CASE WHEN function_type = 14 THEN amount ELSE 0 END) voice_room_diamond, SUM(CASE WHEN function_type = 28 THEN amount ELSE 0 END) video_revenue_diamond, SUM(CASE WHEN function_type = 25 THEN amount ELSE 0 END) family_revenue_diamond, sum(amount) AS total_diamond FROM currency_record.diamond_currency_record WHERE country IN (%s) AND `create_time` >= ? AND `create_time` <= ? AND op_type = 1 AND function_type IN (2, 14, 25, 28) GROUP BY uid


	SELECT uid, SUM(CASE WHEN function_type = 28 THEN CASE WHEN sub_function_type = 3 THEN amount ELSE 0 END ELSE 0 END) video_revenue_diamond_with_video, SUM(CASE WHEN function_type = 2 THEN amount ELSE 0 END) chat_gift_diamond, SUM(CASE WHEN function_type = 14 THEN amount ELSE 0 END) voice_room_diamond, SUM(CASE WHEN function_type = 28 THEN amount ELSE 0 END) video_revenue_diamond, SUM(CASE WHEN function_type = 25 THEN amount ELSE 0 END) family_revenue_diamond, sum(amount) AS total_diamond FROM currency_record.diamond_currency_record WHERE country IN (%s) AND `create_time` >= ? AND `create_time` <= ? AND op_type = 1 AND function_type IN (2, 14, 25, 28) GROUP BY uid
